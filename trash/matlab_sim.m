clear all
close all
clc
u1 = [1.5014549205698875,
 -0.4839922184815857,
 0.26893355385168105,
 0.1861597538917254,
 0.11225863216666197,
 0.04926578709392978,
 0.04507734093761039,
 0.012777876366054963,
 0.013721623836779898,
 0.00594591163746452,
 0.003518616910313614,
 0.0012958759230377642,
 0.0006490435931034721,
 0.00029686641466898726,
 3.521922460520269e-05,
 -0.0003293494071040456,
 -0.0011335774253189246,
 -0.003113938061492459,
 -0.007921546696757204,
 -0.019156977953484585,
 -0.04435268354347585,
 2.9124210196384794,
 3.4491750289745142,
 1.1486892763303e-06];

u2 = [2.791206823638833,
 2.5854445524399647,
 2.631273247027704,
 2.2631858162833685,
 2.0264210908306355,
 1.94452285773401,
 1.8907194740371982,
 1.8623944798724603,
 1.848052609058135,
 1.8385594407529253,
 1.8352709820554436,
 1.834287372945769,
 1.8341822452367738,
 1.8341354076585292,
 1.8341099841477044,
 1.834091237150519,
 1.8340639584046898,
 1.833999458187751,
 1.8338316221857096,
 1.8334066965133229,
 1.8323817634250295,
 0.1533188039874153,
 1.306855059195051e-07,
 0.0];

x0 = [0.0, 10.043285238623751, 0.0, 0.138436, 0.0, 0.0, 0.0, 4.031000000000001, 3.4314999999999998, 0.0];
t = 12.49533084547986;

[tt,xt] = ode15s(@(t,x) matlab_model(t,x,u1(1),u2(1)),[0 t],x0);
x0 = xt(end,:);
y = xt;
for i=2:24
    disp(i)
    [tt,xt] = ode15s(@(t,x) matlab_model(t,x,u1(i),u2(i)),[0 t],x0);
    x0 = xt(end,:);
    y = [y;xt];
end

figure(1)
plot(y(:,10),y(:,8))
